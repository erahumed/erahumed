<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulation workflow • erahumed</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">erahumed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/erahumed-workflow.html">Simulation workflow</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/erahumed/erahumed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="erahumed-workflow_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="erahumed-workflow_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="erahumed-workflow_files/plotly-binding-4.10.4/plotly.js"></script><script src="erahumed-workflow_files/typedarray-0.1/typedarray.min.js"></script><link href="erahumed-workflow_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="erahumed-workflow_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="erahumed-workflow_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="erahumed-workflow_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/erahumed/erahumed/blob/master/vignettes/erahumed-workflow.Rmd" class="external-link"><code>vignettes/erahumed-workflow.Rmd</code></a></small>
      <div class="d-none name"><code>erahumed-workflow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document illustrates the simulation workflow of ERAHUMED.
Specifically, we will cover:</p>
<ul>
<li>How to setup and run a simulation.</li>
<li>How to extract and analyze simulation results.</li>
</ul>
<p>This guide is addressed to users working with the command-line
(<em>i.e.</em> R) interface of <a href="https://github.com/erahumed/erahumed" class="external-link">erahumed</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/erahumed/erahumed" class="external-link">erahumed</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="birds-eye-view">Bird’s eye view<a class="anchor" aria-label="anchor" href="#birds-eye-view"></a>
</h2>
<p>Running a ERAHUMED simulation involves several layers of computation,
which we formalize through the concept of simulation <em>layers</em>.
Concretely, simulations are composed of the following layers:</p>
<ul>
<li>INP: INPut data.</li>
<li>HBA: Hydrological Balance of the Albufera lake.</li>
<li>HBP: Hydrological Balance of rice Paddy clusters.</li>
<li>CA: Chemical Applications.</li>
<li>CT: Chemical Transport.</li>
</ul>
<p>Each layer depends on the previous ones and is a dependency of the
subsequent ones (in the order above). The goal of the following sections
is to teach you how to operate with simulations and layers in
<a href="https://github.com/erahumed/erahumed" class="external-link">erahumed</a>.</p>
</div>
<div class="section level2">
<h2 id="the-simulation-workflow">The simulation workflow<a class="anchor" aria-label="anchor" href="#the-simulation-workflow"></a>
</h2>
<p>We can create a new simulation with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/erahumed_simulation.html">erahumed_simulation</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">s</span></span>
<span><span class="co">#&gt; An ERAHUMED simulation.</span></span>
<span><span class="co">#&gt; Computed layers: None</span></span></code></pre></div>
<p>The object <code>s</code> is, behind the scenes, an R list that
contains simulation layers. The list of ERAHUMED layers can be obtained
through:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/erahumed_layers.html">erahumed_layers</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "inp" "hba" "hbp" "ca"  "ct"</span></span></code></pre></div>
<p>We can extract individual layers as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_layer.html">get_layer</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"hba"</span><span class="op">)</span>  <span class="co"># Extract the HBA layer</span></span>
<span><span class="co">#&gt; A ERAHUMED HBA simulation layer.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output columns:</span></span></code></pre></div>
<p>As revealed by the outputs above, the layers of the simulation are
not yet computed at this stage. This is so because the only result of
<code><a href="../reference/erahumed_simulation.html">erahumed_simulation()</a></code> is to <em>initialize</em> a
simulation, using default values for the parameters required by the
various simulation layers. We show in the following how to setup
individual layers, run the simulation and extract results.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>Setup of individual layers is achieved through the family of
<code>setup_*()</code> functions, that receive a simulation as input,
and return a simulation with the updated setup.</p>
<p>For instance, to configure the height threshold parameter used in HBP
layer computations (see <code><a href="../reference/hbp.html">?setup_hbp</a></code>), we would use:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbp.html">setup_hbp</a></span><span class="op">(</span><span class="va">s</span>, height_thresh_cm <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
<p>Similarly, to limit the date range of the simulation, we can provide
a filtered<br><code>outflows_df</code> data-set to the INP layer:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outflows_df</span> <span class="op">&lt;-</span> <span class="va">albufera_outflows</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="va">.</span><span class="op">[</span><span class="st">"2020-01-01"</span> <span class="op">&lt;=</span> <span class="va">.</span><span class="op">$</span><span class="va">date</span> <span class="op">&amp;</span> <span class="va">.</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"2020-12-31"</span>, <span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inp.html">setup_inp</a></span><span class="op">(</span><span class="va">s</span>, outflows_df <span class="op">=</span> <span class="va">outflows_df</span><span class="op">)</span></span></code></pre></div>
<p>The available parameters for each layer are the arguments of the
corresponding <code>setup_*()</code> function, and the default values
set by <code><a href="../reference/erahumed_simulation.html">erahumed_simulation()</a></code> correspond to the defaults of
the <code>setup_*()</code> arguments. The current layer parameters of a
simulation can be obtained through:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_layer_parameters.html">get_layer_parameters</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"ct"</span><span class="op">)</span>  <span class="co"># Get parameters of CT layer</span></span>
<span><span class="co">#&gt; $drift</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $covmax</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jgrow</span></span>
<span><span class="co">#&gt; [1] 152</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SNK</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dact_m</span></span>
<span><span class="co">#&gt; [1] 0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $css_ppm</span></span>
<span><span class="co">#&gt; [1] 50</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $foc</span></span>
<span><span class="co">#&gt; [1] 0.17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bd_g_cm3</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qseep_m_day</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wilting</span></span>
<span><span class="co">#&gt; [1] 0.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fc</span></span>
<span><span class="co">#&gt; [1] 0.35</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run">Run<a class="anchor" aria-label="anchor" href="#run"></a>
</h3>
<p>Once we are ready with our simulation setup, we can compute the
various layers, using the <code><a href="../reference/run_simulation.html">run_simulation()</a></code> function. In
order to speed up iterations,<br><a href="https://github.com/erahumed/erahumed" class="external-link">erahumed</a> gives you the option to compute just a specific
layer with all its upstream dependencies. For example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span><span class="va">s</span>, layer <span class="op">=</span> <span class="st">"hbp"</span><span class="op">)</span></span>
<span><span class="va">s</span></span>
<span><span class="co">#&gt; An ERAHUMED simulation.</span></span>
<span><span class="co">#&gt; Computed layers: inp, hba, hbp</span></span></code></pre></div>
<p>would compute only the INP, HBA and HBP layers. If you simply want to
compute all layers, you can just call:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="va">s</span></span>
<span><span class="co">#&gt; An ERAHUMED simulation.</span></span>
<span><span class="co">#&gt; Computed layers: inp, hba, hbp, ca, ct</span></span></code></pre></div>
<p>(notice that this will not recompute the INP, HBA and HBP layers,
since these results are already stored in the input simulation
object).</p>
</div>
<div class="section level3">
<h3 id="analyse">Analyse<a class="anchor" aria-label="anchor" href="#analyse"></a>
</h3>
<p>Once we have setup and ran a simulation, we want to analyse its
result, which will be essentially time-series data-sets (possibly with a
spatial component identified by a <code>cluster_id</code>).</p>
<p>You can extract the output (a <code>data.frame</code>) of a given
layer as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hbp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_layer_output.html">get_layer_output</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"hbp"</span><span class="op">)</span>  <span class="co"># Get output data.frame of HBP layer</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hbp_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ideal_height_eod_cm ideal_irrigation ideal_draining petp_cm   area_m2</span></span>
<span><span class="co">#&gt; 1                  20             TRUE           TRUE  -0.058 114881.78</span></span>
<span><span class="co">#&gt; 2                  20             TRUE           TRUE  -0.058 116539.90</span></span>
<span><span class="co">#&gt; 3                  20             TRUE           TRUE  -0.058 154730.35</span></span>
<span><span class="co">#&gt; 4                  20             TRUE           TRUE  -0.058 163789.56</span></span>
<span><span class="co">#&gt; 5                  20             TRUE           TRUE  -0.058  83016.51</span></span>
<span><span class="co">#&gt; 6                  20             TRUE           TRUE  -0.058 106260.07</span></span>
<span><span class="co">#&gt;   capacity_m3_s       date                cluster_id ditch seed_day tancat</span></span>
<span><span class="co">#&gt; 1    0.06004514 2020-01-01 02_Carrera_del_Saler0-2_0    d2     -110   TRUE</span></span>
<span><span class="co">#&gt; 2    0.06004514 2020-01-01          03_Petxinar0-3_2    d2     -110   TRUE</span></span>
<span><span class="co">#&gt; 3    0.06004514 2020-01-01          03_Petxinar0-3_3    d2     -110   TRUE</span></span>
<span><span class="co">#&gt; 4    0.06004514 2020-01-01          03_Petxinar1-3_1    d2     -110   TRUE</span></span>
<span><span class="co">#&gt; 5    0.06004514 2020-01-01          03_Petxinar1-3_2    d2     -110   TRUE</span></span>
<span><span class="co">#&gt; 6    0.06004514 2020-01-01          03_Petxinar1-3_3    d2     -110   TRUE</span></span>
<span><span class="co">#&gt;      variety height_sod_cm irrigation draining ideal_diff_flow_cm</span></span>
<span><span class="co">#&gt; 1   J.Sendra            20       TRUE     TRUE              0.058</span></span>
<span><span class="co">#&gt; 2   J.Sendra            20       TRUE     TRUE              0.058</span></span>
<span><span class="co">#&gt; 3      Bomba            20       TRUE     TRUE              0.058</span></span>
<span><span class="co">#&gt; 4      Bomba            20       TRUE     TRUE              0.058</span></span>
<span><span class="co">#&gt; 5   J.Sendra            20       TRUE     TRUE              0.058</span></span>
<span><span class="co">#&gt; 6 Clearfield            20       TRUE     TRUE              0.058</span></span>
<span><span class="co">#&gt;   ideal_inflow_cm ideal_outflow_cm outflow_m3_s outflow_cm inflow_cm</span></span>
<span><span class="co">#&gt; 1               5            4.942            0          0     0.058</span></span>
<span><span class="co">#&gt; 2               5            4.942            0          0     0.058</span></span>
<span><span class="co">#&gt; 3               5            4.942            0          0     0.058</span></span>
<span><span class="co">#&gt; 4               5            4.942            0          0     0.058</span></span>
<span><span class="co">#&gt; 5               5            4.942            0          0     0.058</span></span>
<span><span class="co">#&gt; 6               5            4.942            0          0     0.058</span></span>
<span><span class="co">#&gt;    inflow_m3_s height_eod_cm plan_delay</span></span>
<span><span class="co">#&gt; 1 0.0007711971            20          0</span></span>
<span><span class="co">#&gt; 2 0.0007823281            20          0</span></span>
<span><span class="co">#&gt; 3 0.0010386991            20          0</span></span>
<span><span class="co">#&gt; 4 0.0010995133            20          0</span></span>
<span><span class="co">#&gt; 5 0.0005572868            20          0</span></span>
<span><span class="co">#&gt; 6 0.0007133199            20          0</span></span></code></pre></div>
<p>From here on, the analysis may proceed in the way you find more
convenient. For instance, in the chunk below I create a plot of water
levels for a set of clusters with similar features, using
<code>dplyr</code> and <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ditch</span> <span class="op">&lt;-</span> <span class="st">"d4"</span></span>
<span><span class="va">tancat</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">variety</span> <span class="op">&lt;-</span> <span class="st">"Clearfield"</span></span>
<span></span>
<span><span class="va">clusters_df</span> <span class="op">&lt;-</span> <span class="va">hbp_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ditch</span> <span class="op">==</span> <span class="op">!</span><span class="op">!</span><span class="va">ditch</span>, <span class="va">tancat</span> <span class="op">==</span> <span class="op">!</span><span class="op">!</span><span class="va">tancat</span>, <span class="va">variety</span> <span class="op">==</span> <span class="op">!</span><span class="op">!</span><span class="va">variety</span><span class="op">)</span></span>
<span></span>
<span><span class="va">avg_df</span> <span class="op">&lt;-</span> <span class="va">clusters_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>height_eod_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">height_eod_cm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">clusters_df</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">height_eod_cm</span>, group <span class="op">=</span> <span class="va">cluster_id</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">avg_df</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">height_eod_cm</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Height [cm]"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Cluster simulated water levels"</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Ditch:"</span>, <span class="va">ditch</span>, <span class="st">"- Tancat:"</span>, <span class="va">tancat</span>, <span class="st">"- Variety:"</span>, <span class="va">variety</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p><img src="erahumed-workflow_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="predefined-plotting-methods">Predefined plotting methods<a class="anchor" aria-label="anchor" href="#predefined-plotting-methods"></a>
</h2>
<p><a href="https://github.com/erahumed/erahumed" class="external-link">erahumed</a> comes equipped with a few basic plotting
methods that return interactive visualizations of the various model
layers. These can be used by accessing the relevant model layer through
<code><a href="../reference/get_layer.html">get_layer()</a></code>, for example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_layer.html">get_layer</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"hba"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"visdat":{"25094483bd18":["function () ","plotlyVisDat"],"25091c919be4":["function () ","data"],"25099cbd250":["function () ","data"]},"cur_data":"25099cbd250","attrs":{"25091c919be4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"blue","width":2,"dash":"solid"},"name":"Source: Observed Outflow Data","inherit":true},"25099cbd250":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"red","width":2,"dash":"dash"},"name":"Source: Imputed Outflow Data","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Time Series of Lake Volume [m³]","xaxis":{"domain":[0,1],"automargin":true,"title":"Date"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Lake Volume [m³]"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2020-01-01","2020-01-02","2020-01-03","2020-01-04","2020-01-05","2020-01-06","2020-01-07","2020-01-08","2020-01-09","2020-01-10","2020-01-11","2020-01-12","2020-01-13","2020-01-14","2020-01-15","2020-01-16","2020-01-17","2020-01-18","2020-01-19","2020-01-20","2020-01-21","2020-01-22","2020-01-23","2020-01-24","2020-01-25","2020-01-26","2020-01-27","2020-01-28","2020-01-29","2020-01-30","2020-01-31","2020-02-01","2020-02-02","2020-02-03","2020-02-04","2020-02-05","2020-02-06","2020-02-07","2020-02-08","2020-02-09","2020-02-10","2020-02-11","2020-02-12","2020-02-13","2020-02-14","2020-02-15","2020-02-16","2020-02-17","2020-02-18","2020-02-19","2020-02-20","2020-02-21","2020-02-22","2020-02-23","2020-02-24","2020-02-25","2020-02-26","2020-02-27","2020-02-28","2020-02-29","2020-03-01","2020-03-02","2020-03-03","2020-03-04","2020-03-05","2020-03-06","2020-03-07","2020-03-08","2020-03-09","2020-03-10","2020-03-11","2020-03-12","2020-03-13","2020-03-14","2020-03-15","2020-03-16","2020-03-17","2020-03-18","2020-03-19","2020-03-20","2020-03-21","2020-03-22","2020-03-23","2020-03-24","2020-03-25","2020-03-26","2020-03-27","2020-03-28","2020-03-29","2020-03-30","2020-03-31","2020-04-01","2020-04-02","2020-04-03","2020-04-04","2020-04-05","2020-04-06","2020-04-07","2020-04-08","2020-04-09","2020-04-10","2020-04-11","2020-04-12","2020-04-13","2020-04-14","2020-04-15","2020-04-16","2020-04-17","2020-04-18","2020-04-19","2020-04-20","2020-04-21","2020-04-22","2020-04-23","2020-04-24","2020-04-25","2020-04-26","2020-04-27","2020-04-28","2020-04-29","2020-04-30","2020-05-01","2020-05-02","2020-05-03","2020-05-04","2020-05-05","2020-05-06","2020-05-07","2020-05-08","2020-05-09","2020-05-10","2020-05-11","2020-05-12","2020-05-13","2020-05-14","2020-05-15","2020-05-16","2020-05-17","2020-05-18","2020-05-19","2020-05-20","2020-05-21","2020-05-22","2020-05-23","2020-05-24","2020-05-25","2020-05-26","2020-05-27","2020-05-28","2020-05-29","2020-05-30","2020-05-31","2020-06-01","2020-06-02","2020-06-03","2020-06-04","2020-06-05","2020-06-06","2020-06-07","2020-06-08","2020-06-09","2020-06-10","2020-06-11","2020-06-12","2020-06-13","2020-06-14","2020-06-15","2020-06-16","2020-06-17","2020-06-18","2020-06-19","2020-06-20","2020-06-21","2020-06-22","2020-06-23","2020-06-24","2020-06-25","2020-06-26","2020-06-27","2020-06-28","2020-06-29","2020-06-30","2020-07-01","2020-07-02","2020-07-03","2020-07-04","2020-07-05","2020-07-06","2020-07-07","2020-07-08","2020-07-09","2020-07-10","2020-07-11","2020-07-12","2020-07-13","2020-07-14","2020-07-15","2020-07-16","2020-07-17","2020-07-18","2020-07-19","2020-07-20","2020-07-21","2020-07-22","2020-07-23","2020-07-24","2020-07-25","2020-07-26","2020-07-27","2020-07-28","2020-07-29","2020-07-30","2020-07-31","2020-08-01","2020-08-02","2020-08-03","2020-08-04","2020-08-05","2020-08-06","2020-08-07","2020-08-08","2020-08-09","2020-08-10","2020-08-11","2020-08-12","2020-08-13","2020-08-14","2020-08-15","2020-08-16","2020-08-17","2020-08-18","2020-08-19","2020-08-20","2020-08-21","2020-08-22","2020-08-23","2020-08-24","2020-08-25","2020-08-26","2020-08-27","2020-08-28","2020-08-29","2020-08-30","2020-08-31","2020-09-01","2020-09-02","2020-09-03","2020-09-04","2020-09-05","2020-09-06","2020-09-07","2020-09-08","2020-09-09","2020-09-10","2020-09-11","2020-09-12","2020-09-13","2020-09-14","2020-09-15","2020-09-16","2020-09-17","2020-09-18","2020-09-19","2020-09-20","2020-09-21","2020-09-22","2020-09-23","2020-09-24","2020-09-25","2020-09-26","2020-09-27","2020-09-28","2020-09-29","2020-09-30","2020-10-01","2020-10-02","2020-10-03","2020-10-04","2020-10-05","2020-10-06","2020-10-07","2020-10-08","2020-10-09","2020-10-10","2020-10-11","2020-10-12","2020-10-13","2020-10-14","2020-10-15","2020-10-16","2020-10-17","2020-10-18","2020-10-19","2020-10-20","2020-10-21","2020-10-22","2020-10-23","2020-10-24","2020-10-25","2020-10-26","2020-10-27","2020-10-28","2020-10-29","2020-10-30","2020-10-31","2020-11-01","2020-11-02","2020-11-03","2020-11-04","2020-11-05","2020-11-06","2020-11-07","2020-11-08","2020-11-09","2020-11-10","2020-11-11","2020-11-12","2020-11-13","2020-11-14","2020-11-15","2020-11-16","2020-11-17","2020-11-18","2020-11-19","2020-11-20","2020-11-21","2020-11-22","2020-11-23","2020-11-24","2020-11-25","2020-11-26","2020-11-27","2020-11-28","2020-11-29","2020-11-30","2020-12-01","2020-12-02","2020-12-03","2020-12-04","2020-12-05","2020-12-06","2020-12-07","2020-12-08","2020-12-09","2020-12-10","2020-12-11","2020-12-12","2020-12-13","2020-12-14","2020-12-15","2020-12-16","2020-12-17","2020-12-18","2020-12-19","2020-12-20","2020-12-21","2020-12-22","2020-12-23","2020-12-24","2020-12-25","2020-12-26","2020-12-27","2020-12-28","2020-12-29","2020-12-30"],"y":[27398436.583338588,27339292.333338588,27391865,27451009.25,27474009.791661404,27391865,27396793.68749211,27403365.270830702,27474009.791661404,27391865,27630084.895822816,27667871.500007883,27705658.104169294,27518367.979161404,27255504.645830702,27007427.375,24513511.49999211,24324249.899992112,24182303.699992113,24048243.400007881,23953612.600007884,24205961.399992112,24166531.900007881,24608142.299992114,23985156.199999999,23772236.899999999,23141364.899992112,23165022.599992111,23212337.99999211,22959989.200007886,22794385.300007883,24979624.517863899,24428080.916661408,23724921.499999996,23516273.729177177,23263267.770830702,23286268.31249211,23465343.958338588,23619776.166677177,23673991.729161408,23815280.770822816,23629633.541661408,23524488.208338588,23373341.791669294,23207409.3125,23483415.812507883,23926997.687507883,23501487.666677177,23197551.93749211,23345412.562492114,23135121.895822816,23015190.5,22919902.541661408,23186051.666661408,23287911.208338588,23455486.583330702,23535988.479169294,23700278.06249211,23021762.083338588,23516273.729177177,23690420.687507883,24879877.270822816,23784065.749999996,23373341.791669294,23838281.312507883,23407842.604161408,22719469.25,22382675.604169294,22420462.208330702,22440176.958322816,22586394.6875,22727683.729161408,22744112.687507883,22793399.5625,22726040.833338588,23123621.62499211,23414414.1875,23894139.770838588,23501487.666677177,22795042.458322816,22721112.145822816,22783542.187492114,22768756.12499211,21996595.083322816,21231399.919999998,21941130.919999998,21714016.999999996,21411198.439999998,23147816.999998562,22520678.854161408,23205766.416677177,23981213.24999211,24497082.541669294,24960379.166661408,24753374.291661408,23997499.347815797,23215623.791661408,22546965.18749211,22336674.520822816,22201957.062499996,22349817.6875,22379389.8125,22441819.854169294,22634038.666669294,22717826.354177181,23212337.99999211,23534345.583322816,23310911.75,22929759.916669294,23085823.201443784,23904422.230759468,24513511.49999211,24401794.583330702,24393580.104169294,22946188.87499211,22620895.49999211,22576537.31249211,22882115.9375,23005333.12499211,22558465.458322816,22788470.875007883,22867329.874999996,22474677.770838588,22576537.31249211,22919902.541661408,23204123.520830702,23437414.729161408,23650991.187499996,23831709.729169294,24345936.124999996,25446676.333338588,25579750.895838588,24525011.770822816,25068810.291677177,25571536.416677177,25638895.145838588,25175598.520822816,25137811.916661404,24830590.395830702,24564441.270830702,24364007.979169294,24150431.520830702,24017356.958330702,23608275.895822816,23388127.854169294,23669063.041669294,23889211.083322816,23987784.833330702,23954926.916661408,24010785.37499211,23550774.541669294,23248481.708330702,23389770.74999211,23570489.291661408,23624704.854169294,24166860.479177177,23761065.208338588,23496558.979161408,23406199.708338588,23802137.604169294,23739707.5625,23695349.374999996,23877710.81249211,24439581.18749211,23953284.020838588,23428343.086957891,23233695.645830702,23163051.124999996,23297768.583322816,23468629.750007883,23606632.999999996,23828423.937499996,23716707.020838588,23457129.479177177,23416057.083322816,23396342.333330702,23494916.083338588,23547488.749999996,23775851.270838588,23825138.145830702,23738064.666677177,23588561.145830702,23529416.895830702,23552417.43749211,23343769.666669294,23701920.958338588,23609918.791669294,23503130.5625,23338840.979177181,23641133.81249211,23861281.854169294,23936855.06249211,23910568.729161408,23954926.916661408,23887568.1875,23621419.0625,23508059.24999211,23517916.625,23483415.812507883,23600061.416661408,23782422.854177181,24017356.958330702,23940140.854161404,23782422.854177181,23696992.270822816,23499844.770830702,23476844.229169294,23353627.041677177,23411128.395830702,23526131.104161408,23519559.520822816,23802137.604169294,23775851.270838588,23703563.854161408,23696992.270822816,23803780.49999211,23912211.625007883,23828423.937499996,23777494.166661408,23708492.541677181,23611561.68749211,23427557.354177177,23563917.708322816,23632919.333330702,24084715.687492114,24165217.583330702,24161931.791661408,24219433.145838588,24180003.645830702,24056786.458338588,23854710.270830702,23716707.020838588,23857996.062499996,23936855.06249211,23979570.354169294,23772565.479169294,23815280.770822816,23853067.375007883,23677277.520830702,23558989.020830702,23774208.37499211,24418223.541677177,24888091.750007883,24713944.791677177,24318006.895822816,24050214.875,23872782.125,23468629.750007883,23514630.833330702,23550774.541669294,23353627.041677177,24663015.020838588,24955450.479169294,24659729.229169294,24055143.56249211,23756136.520822816,23629633.541661408,23366770.208330702,23310911.75,23286268.31249211,23498201.875007883,23825138.145830702,24191503.916661408,23979570.354169294,23696992.270822816,24060072.250007883,24349221.916669294,24176717.854161408,23646062.500007883,23432486.041669294,23499844.770830702,23721635.708330702,23941783.750007883,24069929.62499211,24442866.979161408,25017880.520838588,24830590.395830702,24641657.375,24201361.291669294,24176717.854161408,24120859.395830702,24046929.083330702,24176717.854161408,24025571.437492114,23963141.395822816,23958212.708330702,24046929.083330702,24084715.687492114,24295006.354161408,24258862.645822816,24249005.270838588,24171789.166669294,24125788.083322816,24025571.437492114,23958212.708330702,23716707.020838588,23790637.333338588,23013547.604177177,22665253.68749211,22422105.104177177,21515226.604161408,20951713.333338588,20770994.791669294,20552489.645838588,20371771.104169294,20197624.145838588,20051406.416661408,19975833.208338588,19353175.687492114,26128478.104161408,37370814.291677177,36237216.166669294,33281646.56249211,30404935.958330702,28688109.812507883,28182097.895838588,28162383.145822816,27700729.416677177,27625156.208330702,27786160.000007883,27602155.666669294,27593941.187507883,27631727.791669294,27584083.812499996,27240718.583330702,27129001.666669294,27170074.062499996,27235789.895838588,27367221.56249211,27290005.458322816,27120787.187507883,27142144.833322816,29064332.958322816,29263123.354161404,28628965.562507883,27723729.958338588,27487152.958338588,27616941.729169294,27855161.62499211,28017808.31249211,28303672.187507883,28047380.43749211,28011236.729177177,27736873.12499211,27782874.208338588,27784517.104161408,27722087.06249211,27630084.895822816,27483867.166669294,27633370.68749211,27409936.854169294,27391865,27391865,27423080.020822816,27342578.125007883,27199646.1875,27152002.208330702,27189788.81249211,27033713.708330702,27092857.958330702,26994284.208322816,27363935.770822816,27495367.437499996,27336006.541669294,27071500.31249211],"type":"scatter","mode":"lines","line":{"color":"blue","width":2,"dash":"solid"},"name":"Source: Observed Outflow Data","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"lines","line":{"color":"red","width":2,"dash":"dash"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The documentation of the various plotting methods can be found under
<code>?plot.erahumed_&lt;layer_name&gt;</code>, <em>e.g.</em>
<code><a href="../reference/plot.erahumed_hba.html">?plot.erahumed_hba</a></code>.</p>
</div>
<div class="section level2">
<h2 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h2>
<p>TODO. Further details will appear in this and possibly other
vignettes. For specific problems, you can <a href="https://github.com/erahumed/erahumed/issues" class="external-link">file an issue on
Github</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Valerio Gherardi, Pablo Amador.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
