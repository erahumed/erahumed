% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rfcm--allocate.R
\name{allocate_surface}
\alias{allocate_surface}
\title{Allocate a Management System to a Surface Fraction}
\usage{
allocate_surface(
  map,
  system,
  target_fraction,
  ditches = 1:26,
  field_type = c("both", "regular", "tancat")
)
}
\arguments{
\item{map}{\verb{[erahumed_rfms_map]} \cr A cluster map created with \code{new_rfms_map()} or \code{default_rfms_map()}.}

\item{system}{\verb{[erahumed_management_system]} \cr A management system to assign, created with \code{new_management_system()} or helper functions such as \code{bomba()} or \code{clearfield()}.}

\item{target_fraction}{\verb{[numeric(1)]} \cr The fraction of surface area \strong{within the selected subset} of clusters (filtered by \code{ditches} and \code{field_type}) to allocate to the given system. Must be a number between 0 and 1.}

\item{ditches}{\verb{[integer]} \cr A vector of ditch IDs (e.g., 1:26) defining the subset of clusters to be considered for allocation. Defaults to all ditches.}

\item{field_type}{\verb{[character(1)]} \cr Type of field to consider when selecting clusters. Must be one of:
\itemize{
\item \code{"regular"} – only regular fields
\item \code{"tancat"} – only tancats
\item \code{"both"} – all field types (default).
}}
}
\value{
An updated \code{erahumed_rfms_map} object with the new system
allocated to selected clusters.
}
\description{
Assigns a new management system to a fraction of surface area by selecting
clusters that match given spatial and structural criteria, using only the
subset of eligible clusters defined by \code{ditches} and \code{field_type}.
}
\details{
This function allocates a management system to a subset of clusters selected
based on the \code{ditches} and \code{field_type} criteria. The \code{target_fraction} refers
to the fraction of \strong{total surface area within this eligible subset}, not the
entire map.

Clusters are randomly selected from the eligible subset until the cumulative
surface area of selected clusters reaches the desired fraction.

If the requested fraction exceeds the total available surface in the subset
(e.g., due to prior allocations), the
function will issue a warning and perform a \strong{partial allocation} using all
remaining candidates. The map is returned with the maximum possible surface
allocated under the given constraints.
}
