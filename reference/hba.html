<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HBA: Hydrological Balance of the Albufera Lake — hba • erahumed</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="HBA: Hydrological Balance of the Albufera Lake — hba"><meta name="description" content="This model component completes the partial hydrological balance information
provided as input data, by computing the total inflow to the Albufera lake,
as well as, if relevant, the amount of unaccounted outflow - usually
attributed to tancats that suck water from the lake.
It is the second modeling layer, and requires the inp component of the
model to be previously defined."><meta property="og:description" content="This model component completes the partial hydrological balance information
provided as input data, by computing the total inflow to the Albufera lake,
as well as, if relevant, the amount of unaccounted outflow - usually
attributed to tancats that suck water from the lake.
It is the second modeling layer, and requires the inp component of the
model to be previously defined."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">erahumed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/erahumed/erahumed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>HBA: Hydrological Balance of the Albufera Lake</h1>
      <small class="dont-index">Source: <a href="https://github.com/erahumed/erahumed/blob/master/R/hba--main.R" class="external-link"><code>R/hba--main.R</code></a></small>
      <div class="d-none name"><code>hba.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This model component completes the partial hydrological balance information
provided as input data, by computing the total inflow to the Albufera lake,
as well as, if relevant, the amount of unaccounted outflow - usually
attributed to <em>tancats</em> that suck water from the lake.</p>
<p>It is the second modeling layer, and requires the <a href="inp.html">inp</a> component of the
model to be previously defined.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hba</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">compute_hba</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  storage_curve <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">level</span><span class="op">)</span> <span class="fl">16.7459</span> <span class="op">*</span> <span class="fl">1e+06</span> <span class="op">+</span> <span class="va">level</span> <span class="op">*</span> <span class="fl">23.6577</span> <span class="op">*</span> <span class="fl">1e+06</span>,</span>
<span>  petp_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">P</span>, <span class="va">ETP</span><span class="op">)</span> <span class="fl">114.225826072</span> <span class="op">*</span> <span class="fl">1e+06</span> <span class="op">*</span> <span class="va">P</span> <span class="op">-</span> <span class="fl">79.360993685</span> <span class="op">*</span> <span class="fl">1e+06</span> <span class="op">*</span> <span class="va">ETP</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>An object of class <a href="erahumed_model.html">erahumed_model</a>, with a pre-computed
<a href="inp.html">inp</a> component (<em>i.e.</em> such that <code>inp(model)</code> is not <code>NULL</code>).</p></dd>


<dt id="arg-storage-curve">storage_curve<a class="anchor" aria-label="anchor" href="#arg-storage-curve"></a></dt>
<dd><p>a function that takes a numeric vector as input, and
returns a numeric vector of the same length. Function that converts lake
levels into lake <em>volumes</em>.</p></dd>


<dt id="arg-petp-function">petp_function<a class="anchor" aria-label="anchor" href="#arg-petp-function"></a></dt>
<dd><p>a function that takes two numeric vectors of common
length as inputs, and returns a numeric vector of the same length. Function
that converts precipitation and evapotranspiration values into an overall
volume change.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Objects of class <a href="erahumed_model.html">erahumed_model</a> and <code>erahumed_hba</code>, for
<code>compute_hba()</code> and <code>hba()</code> respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The numeric inputs for the linear storage curve are taken from the CHJ report
<a href="https://www.chj.es/Descargas/ProyectosOPH/Consulta%20publica/PHC-2015-2021/ReferenciasBibliograficas/HumedalesZonasProtegidas/CHJ,2012.Aquatool_Albufera.pdf" class="external-link">Modelo de seguimiento de l’Albufera de Valencia con AQUATOOLDMA.</a>.
The values used as the arguments of <code>petp_function()</code> were calculated by the
package authors, and correspond to the total study area (<code>surface_P</code>) and
the flooded surface (<code>surface_ETP</code>).</p>
<p>The output data.frame of the calculated HBA component contains a copy of the
input data, as well as the following additional columns:</p><ul><li><p><code>volume</code> Volume time series, obtained from the storage curve.</p></li>
<li><p><code>volume_change</code> Differenced time series of volume. The \(n\)-th is given
by \(\Delta V _n \equiv V_{n+1}-V_n\), where \(V_n\) is volume at time
step \(n\).</p></li>
<li><p><code>petp_change</code> Time series. The amount \(\Delta V _n ^\text{P-ETP}\) of
volume change due to precipitation and evapotranspiration, obtained from the
P-ETP surface.</p></li>
<li><p><code>outflow_total</code> Time series of total outflows, measured in cube meters per
second. This is the sum
\(\sum _i O_i\) of time series passed through the <code>outflows</code> argument,
plus an extra term \(\delta O\) of unaccounted outflow. The correction term
is defined by
\(\delta O = \frac{\Delta V _n - \Delta V _n ^\text{P-ETP}}{24 \times 60 \times 60} -\sum _i O_i\)
and is chosen in such a way to ensure that the total inflow is always
non-negative.</p></li>
<li><p><code>outflow_extra</code> Time series. The unaccounted outflow term \(\delta O\)
described above.</p></li>
<li><p><code>inflow_total</code> Time serie of total inflows, in cube meters per second.
This is computed as \(I = \sum _{i} O_i + \delta O + \frac{\Delta V _n - \Delta V _n ^\text{P-ETP}}{24 \times 60 \times 60}\).</p></li>
<li><p><code>residence_time_days</code>. Residence time, as modeled by <a href="hba_residence_time.html">hba_residence_time</a>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other model components:
<code><a href="ca.html">ca</a>()</code>,
<code><a href="ct.html">ct</a>()</code>,
<code><a href="hbp.html">hbp</a>()</code>,
<code><a href="inp.html">inp</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pablo Amador Crespo, Valerio Gherardi</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Valerio Gherardi, Pablo Amador.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

